<template>
  <div class="multi-agent-farm-simulation">
    <!-- æ•´ä½“å®¹å™¨ï¼Œä½¿ç”¨ flex å¸ƒå±€å®ç°æ¨ªè¡Œå¸ƒå±€ -->
    <div class="row-layout">
      <div class="left-column">
        <div class="agent-cards">
          <!-- Agent 1 -->
          <div class="agent-card">
            <h3>Agent 1 - å†œåœºç§æ¤è§„åˆ’ Agent</h3>
            <div class="input-group inline-input-group">
              <label for="agent1-name">åç§°</label>
              <el-input v-model="agent1Name" placeholder="ä¾‹å¦‚ï¼šæ™ºèƒ½ç§æ¤è§„åˆ’ Agent" />
            </div>
            <div class="input-group inline-input-group">
              <label for="agent1-role">è§’è‰²</label>
              <el-input
                v-model="agent1Role"
                placeholder="ä¾‹å¦‚ï¼šæ ¹æ®å†œåœºåœŸåœ°æƒ…å†µå’Œå¸‚åœºéœ€æ±‚ï¼Œåˆ¶å®šç§æ¤è®¡åˆ’"
              />
            </div>
            <div class="input-group inline-input-group">
              <label for="agent1-count">æ•°é‡</label>
              <el-select v-model="agent1Count" placeholder="è¯·é€‰æ‹©">
                <el-option
                  v-for="count in agentCountOptions"
                  :key="count"
                  :label="count"
                  :value="count"
                />
              </el-select>
            </div>
          </div>
          <!-- Agent 2 -->
          <div class="agent-card">
            <h3>Agent 2 - å†œåœºå…»æ®–ç®¡ç† Agent</h3>
            <div class="input-group inline-input-group">
              <label for="agent2-name">åç§°</label>
              <el-input v-model="agent2Name" placeholder="ä¾‹å¦‚ï¼šæ™ºèƒ½å…»æ®–ç®¡ç† Agent" />
            </div>
            <div class="input-group inline-input-group">
              <label for="agent2-role">è§’è‰²</label>
              <el-input
                v-model="agent2Role"
                placeholder="ä¾‹å¦‚ï¼šè´Ÿè´£å†œåœºå…»æ®–åŠ¨ç‰©çš„æ—¥å¸¸ç®¡ç†å’Œç–¾ç—…é˜²æ§"
              />
            </div>
            <div class="input-group inline-input-group">
              <label for="agent2-count">æ•°é‡</label>
              <el-select v-model="agent2Count" placeholder="è¯·é€‰æ‹©">
                <el-option
                  v-for="count in agentCountOptions"
                  :key="count"
                  :label="count"
                  :value="count"
                />
              </el-select>
            </div>
          </div>
          <!-- Agent 3 -->
          <!-- éšæœºç”Ÿæˆ Agent è§’è‰² 1 -->
          <div class="agent-card random-agent-generation">
            <h3>éšæœºç”Ÿæˆ Agent è§’è‰² 1</h3>
            <div class="input-group">
              <button @click="generateRandomAgent1" class="generate-button">
                ç”Ÿæˆéšæœº Agent 1
              </button>
            </div>
            <div v-if="randomAgent1" class="input-group inline-input-group">
              <h4>{{ randomAgent1.name }}</h4>
              <p>è§’è‰²è®¾å®šï¼š{{ randomAgent1.role }}</p>
              <p>æ•°é‡ï¼š{{ randomAgent1.count }}</p>
            </div>
          </div>
          <div class="agent-card random-agent-generation">
            <h3>éšæœºç”Ÿæˆ Agent è§’è‰² 2</h3>
            <div class="input-group">
              <button @click="generateRandomAgent2" class="generate-button">
                ç”Ÿæˆéšæœº Agent 2
              </button>
            </div>
            <div v-if="randomAgent2" class="input-group inline-input-group">
              <h4>{{ randomAgent2.name }}</h4>
              <p>è§’è‰²è®¾å®šï¼š{{ randomAgent2.role }}</p>
              <p>æ•°é‡ï¼š{{ randomAgent2.count }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="right-column">
      <!-- å³ä¾§åŒºåŸŸ -->
      <div class="right-section">
        <!-- å†œä¸šæ™ºèƒ½ä½“å’Œä½œç‰©ç®¡ç† -->
        <div class="agent-card random-agent-generation">
          <div class="agent-card">
            <h3>Agent 3 - å†œåœºé”€å”®æ¨å¹¿ Agent</h3>
            <div class="input-group inline-input-group">
              <label for="agent3-name">åç§°</label>
              <el-input v-model="agent3Name" placeholder="ä¾‹å¦‚ï¼šæ™ºèƒ½é”€å”®æ¨å¹¿ Agent" />
            </div>
            <div class="input-group inline-input-group">
              <label for="agent3-role">è§’è‰²</label>
              <el-input
                v-model="agent3Role"
                placeholder="ä¾‹å¦‚ï¼šé€šè¿‡å„ç§æ¸ é“æ¨å¹¿å†œåœºäº§å“ï¼Œæé«˜é”€å”®é¢"
              />
            </div>
            <div class="input-group inline-input-group">
              <label for="agent3-count">æ•°é‡</label>
              <el-select v-model="agent3Count" placeholder="è¯·é€‰æ‹©">
                <el-option
                  v-for="count in agentCountOptions"
                  :key="count"
                  :label="count"
                  :value="count"
                />
              </el-select>
            </div>
          </div>
        </div>
      </div>
      <div class="right-section">
        <div class="agent-card random-agent-generation">
          <div class="agent-card">
            <h3>ğŸ¤– å†œä¸šæ™ºèƒ½ä½“</h3>
            <div class="btn-group">
              <div class="input-group inline-input-group">
                <label for="agent3-name">åç§°</label>
                <el-input v-model="agent3Name" placeholder="ä¾‹å¦‚ï¼šæ™ºèƒ½é”€å”®æ¨å¹¿ Agent" />
              </div>
              <div class="input-group inline-input-group">
                <label for="agent3-role">è§’è‰²</label>
                <el-input
                  v-model="agent3Role"
                  placeholder="ä¾‹å¦‚ï¼šé€šè¿‡å„ç§æ¸ é“æ¨å¹¿å†œåœºäº§å“ï¼Œæé«˜é”€å”®é¢"
                />
              </div>
              <div class="input-group inline-input-group">
                <label for="agent3-count">æ•°é‡</label>
                <el-select v-model="agent3Count" placeholder="è¯·é€‰æ‹©">
                  <el-option
                    v-for="count in agentCountOptions"
                    :key="count"
                    :label="count"
                    :value="count"
                  />
                </el-select>
              </div>
            </div>
          </div>

          <div class="agent-card random-agent-generation">
            <div class="agent-card">
              <h3>ğŸŒ± ä½œç‰©ç®¡ç†</h3>
            </div>
            <div class="btn-group">
              <!-- åˆ›å»ºä½œç‰©ï¼ˆå¯¹åº”æ–°å¢ä½œç‰©ï¼‰ -->
              <button @click="handleCreateCrop">æ–°å¢ä½œç‰©</button>
              <button class="btn btn-sm btn-primary" @click="showAddCropModal">ğŸŒ¾ æ–°å¢ä½œç‰©</button>
              <button class="btn btn-sm btn-warning" @click="refreshCropStatus">ğŸ”„ åˆ·æ–°çŠ¶æ€</button>
              <button class="btn btn-sm btn-info" @click="showUpdateCropStatusModal">
                ğŸŒ± æ›´æ–°çŠ¶æ€
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- ç»Ÿä¸€åˆ›å»ºæ™ºèƒ½ä½“æŒ‰é’® -->
    <div class="create-agent-btn-container">
      <button @click="handleCreateAllAgents" class="generate-button">ç¡®å®š</button>
    </div>
  </div>
</template>

<style scoped>
/* ç§»é™¤ä¸å…¨å±€æ ·å¼å†²çªçš„æŒ‰é’®æ ·å¼ç­‰ */
/* ä¿ç•™ç»„ä»¶ç‰¹å®šçš„æ ·å¼ */
.multi-agent-farm-simulation {
  padding: 20px;
  background-color: #fff;
  color: #333;
  font-family: 'SF Pro Text', 'SF Pro Icons', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif;
}

.row-layout {
  display: flex; /* ä½¿ç”¨ flex å¸ƒå±€ */
  gap: 20px; /* ä¸¤æ ä¹‹é—´çš„é—´è· */
}

.left-column,
.right-column {
  flex: 1;
}

.agent-cards {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
}

.agent-card {
  background-color: #f9f9f9; /* æµ…ç°è‰²èƒŒæ™¯ */
  border: none; /* ç§»é™¤è¾¹æ¡† */
  border-radius: 8px;
  padding: 5px 10px;
  flex: 1 1 calc(50% - 20px);
}

.input-group {
  margin-bottom: 10px;
}

.inline-input-group {
  display: flex; /* ä½¿ç”¨ flex å¸ƒå±€è®©å­å…ƒç´ åœ¨ä¸€è¡Œæ˜¾ç¤º */
  align-items: center; /* å‚ç›´å±…ä¸­å¯¹é½ */
  gap: 10px; /* å…ƒç´ ä¹‹é—´çš„é—´è· */
}

.inline-input-group label {
  margin-bottom: 0; /* ç§»é™¤ label çš„åº•éƒ¨å¤–è¾¹è· */
  white-space: nowrap; /* é˜²æ­¢ label æ–‡å­—æ¢è¡Œ */
}

.inline-input-group .el-input,
.inline-input-group .el-select {
  flex: 1; /* è®©è¾“å…¥æ¡†å æ®å‰©ä½™ç©ºé—´ */
}

.random-agent-generation {
  margin-top: 20px;
  text-align: center;
}

.generate-button {
  padding: 10px 20px;
  background-color: #4caf50;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.task-selection,
.technology-selection {
  margin-top: 20px;
}

.form-label {
  display: block;
  margin-bottom: 5px;
}

.form-control {
  padding: 5px;
  border: 1px solid #ccc;
  border-radius: 3px;
}

.btn-outline-success {
  border: 1px solid #28a745;
  color: #28a745;
  background-color: transparent;
}
.generate-button:hover,
.btn:hover {
  background-color: #004d00; /* æ·±ä¸€ç‚¹çš„å¢¨ç»¿è‰²æ‚¬åœæ•ˆæœ */
}

.btn-outline-success {
  border: 1px solid #006400;
  color: #006400;
  background-color: transparent;
}

.btn-outline-success:hover {
  background-color: #006400;
  color: white;
}

.btn-sm {
  font-size: 0.8rem;
}

.btn-success {
  background-color: #28a745;
  color: white;
}

.btn-primary {
  background-color: #007bff;
  color: white;
}

.btn-warning {
  background-color: #ffc107;
  color: white;
}

.btn-info {
  background-color: #17a2b8;
  color: white;
}

.text-muted {
  font-size: 0.8rem;
  color: #6c757d;
}

.dashboard-card {
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 15px;
  margin-top: 20px;
}

.btn-group {
  margin-bottom: 10px;
}
.generate-button,
.btn {
  padding: 10px 20px;
  background-color: #006400; /* å¢¨ç»¿è‰²æŒ‰é’® */
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

button:hover {
  background: #45a049;
}
</style>

<script setup>
import { ref } from 'vue'
// import { createSimulation, createAgent, createCrop } from '../api'

// Agent 1 ç›¸å…³æ•°æ®
const agent1Name = ref('')
const agent1Role = ref('')
const agent1Count = ref('')

// Agent 2 ç›¸å…³æ•°æ®
const agent2Name = ref('')
const agent2Role = ref('')
const agent2Count = ref('')

// Agent 3 ç›¸å…³æ•°æ®
const agent3Name = ref('')
const agent3Role = ref('')
const agent3Count = ref('')

// å¯é€‰æ‹©çš„ Agent æ•°é‡é€‰é¡¹
const agentCountOptions = [1, 2, 3, 4, 5]

// éšæœºç”Ÿæˆçš„ Agent 1
const randomAgent1 = ref(null)

// éšæœºç”Ÿæˆçš„ Agent 2
const randomAgent2 = ref(null)

// éšæœºç”Ÿæˆ Agent è§’è‰² 1 çš„å‡½æ•°
const generateRandomAgent1 = () => {
  const agentNames = ['æ™ºèƒ½çŒæº‰ Agent', 'åœŸå£¤æ”¹è‰¯ Agent', 'æ°”è±¡é¢„æŠ¥ Agent', 'ä½œç‰©ä¿æŠ¤ Agent']
  const agentRoles = [
    'æ ¹æ®åœŸå£¤æ¹¿åº¦æ•°æ®ï¼Œç²¾å‡†çŒæº‰',
    'å®šæœŸæ”¹è‰¯åœŸå£¤çš„ç»“æ„å’Œè‚¥åŠ›',
    'å®æ—¶é¢„æŠ¥æ°”è±¡å˜åŒ–ï¼Œä¸ºå†œåœºç”Ÿäº§æä¾›å‚è€ƒ',
    'åˆ†æä½œç‰©ç—…è™«å®³æƒ…å†µï¼Œé‡‡å–ç›¸åº”çš„é˜²æ²»æªæ–½',
  ]
  const randomName = agentNames[Math.floor(Math.random() * agentNames.length)]
  const randomRole = agentRoles[Math.floor(Math.random() * agentRoles.length)]
  const randomCount = agentCountOptions[Math.floor(Math.random() * agentCountOptions.length)]
  randomAgent1.value = {
    name: randomName,
    role: randomRole,
    count: randomCount,
  }
}

// éšæœºç”Ÿæˆ Agent è§’è‰² 2 çš„å‡½æ•°
const generateRandomAgent2 = () => {
  const agentNames = ['å†œäº§å“åŠ å·¥ Agent', 'å†œåœºç‰©æµ Agent', 'å†œåœºè´¢åŠ¡ Agent', 'å†œåœºå¸‚åœºåˆ†æ Agent']
  const agentRoles = [
    'è´Ÿè´£å†œäº§å“çš„åŠ å·¥å’ŒåŒ…è£…',
    'ç®¡ç†å†œåœºçš„ç‰©æµè¿è¾“ï¼Œç¡®ä¿å†œäº§å“åŠæ—¶é€è¾¾',
    'è¿›è¡Œå†œåœºçš„è´¢åŠ¡ç®¡ç†ï¼Œæ§åˆ¶æˆæœ¬å’Œé¢„ç®—',
    'åˆ†æå¸‚åœºéœ€æ±‚å’Œè¶‹åŠ¿ï¼Œä¸ºå†œåœºç”Ÿäº§æä¾›å†³ç­–ä¾æ®',
  ]
  const randomName = agentNames[Math.floor(Math.random() * agentNames.length)]
  const randomRole = agentRoles[Math.floor(Math.random() * agentRoles.length)]
  const randomCount = agentCountOptions[Math.floor(Math.random() * agentCountOptions.length)]
  randomAgent2.value = {
    name: randomName,
    role: randomRole,
    count: randomCount,
  }
}

// åˆ›å»ºä½œç‰©
const handleCreateCrop = async () => {
  try {
    // è¿™é‡Œå‡è®¾éœ€è¦ä¸€ä¸ªå•ç‹¬çš„ä½œç‰©åç§°è¾“å…¥æ¡†ï¼Œç›®å‰ä»£ç ä¸­æ²¡æœ‰ï¼Œå¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
    const cropNameInput = 'ä½œç‰©åç§°' // å¯æ›¿æ¢ä¸ºå®é™…è¾“å…¥æ¡†çš„å€¼
    const data = {
      cropName: cropNameInput,
      growthRate: 1.0,
    }
    const result = await createCrop(data)
    cropResult.value = `ä½œç‰© ID: ${result.id}`
  } catch (error) {
    console.error('åˆ›å»ºä½œç‰©å¤±è´¥:', error)
    cropResult.value = 'åˆ›å»ºä½œç‰©å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•'
  }
}
</script>
